/*!
 * Ext JS Library 3.4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.ns("Ext.ux.tree"),Ext.ux.tree.TreeGridSorter=Ext.extend(Ext.tree.TreeSorter,{sortClasses:["sort-asc","sort-desc"],sortAscText:"Sort Ascending",sortDescText:"Sort Descending",constructor:function(n,t){Ext.isObject(t)||(t={property:n.columns[0].dataIndex||"text",folderSort:!0}),Ext.ux.tree.TreeGridSorter.superclass.constructor.apply(this,arguments),this.tree=n;n.on("headerclick",this.onHeaderClick,this);n.ddAppendOnly=!0;var i=this;this.defaultSortFn=function(n,t){var h=i.dir&&i.dir.toLowerCase()=="desc",c=i.property||"text",r=i.sortType,l=i.caseSensitive===!0,u=i.leafAttr||"leaf",f=n.attributes,e=t.attributes;if(i.folderSort){if(f[u]&&!e[u])return 1;if(!f[u]&&e[u])return-1}var o=f[c],s=e[c],a=r?r(o):l?o:o.toUpperCase();return v2=r?r(s):l?s:s.toUpperCase(),a<v2?h?1:-1:a>v2?h?-1:1:0};n.on("afterrender",this.onAfterTreeRender,this,{single:!0});n.on("headermenuclick",this.onHeaderMenuClick,this)},onAfterTreeRender:function(){this.tree.hmenu&&this.tree.hmenu.insert(0,{itemId:"asc",text:this.sortAscText,cls:"xg-hmenu-sort-asc"},{itemId:"desc",text:this.sortDescText,cls:"xg-hmenu-sort-desc"}),this.updateSortIcon(0,"asc")},onHeaderMenuClick:function(n,t,i){if(t==="asc"||t==="desc"){this.onHeaderClick(n,null,i);return!1}},onHeaderClick:function(n,t,i){if(n&&!this.tree.headersDisabled){var r=this;r.property=n.dataIndex,r.dir=n.dir=n.dir==="desc"?"asc":"desc",r.sortType=n.sortType,r.caseSensitive===Ext.isBoolean(n.caseSensitive)?n.caseSensitive:this.caseSensitive,r.sortFn=n.sortFn||this.defaultSortFn,this.tree.root.cascade(function(n){n.isLeaf()||r.updateSort(r.tree,n)}),this.updateSortIcon(i,n.dir)}},updateSortIcon:function(n,t){var i=this.sortClasses,r=this.tree.innerHd.select("td").removeClass(i);r.item(n).addClass(i[t=="desc"?1:0])}});
/*!
 * Ext JS Library 3.4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.tree.ColumnResizer=Ext.extend(Ext.util.Observable,{minWidth:14,constructor:function(n){Ext.apply(this,n),Ext.tree.ColumnResizer.superclass.constructor.call(this)},init:function(n){this.tree=n;n.on("render",this.initEvents,this)},initEvents:function(n){n.mon(n.innerHd,"mousemove",this.handleHdMove,this),this.tracker=new Ext.dd.DragTracker({onBeforeStart:this.onBeforeStart.createDelegate(this),onStart:this.onStart.createDelegate(this),onDrag:this.onDrag.createDelegate(this),onEnd:this.onEnd.createDelegate(this),tolerance:3,autoStart:300}),this.tracker.initEl(n.innerHd);n.on("beforedestroy",this.tracker.destroy,this.tracker)},handleHdMove:function(n){var f=5,e=n.getPageX(),t=n.getTarget(".x-treegrid-hd",3,!0),i,r;if(t){var o=t.getRegion(),u=t.dom.style,s=t.dom.parentNode;if(e-o.left<=f&&t.dom!==s.firstChild){for(i=t.dom.previousSibling;i&&Ext.fly(i).hasClass("x-treegrid-hd-hidden");)i=i.previousSibling;i&&(this.activeHd=Ext.get(i),u.cursor=Ext.isWebKit?"e-resize":"col-resize")}else if(o.right-e<=f){for(r=t.dom;r&&Ext.fly(r).hasClass("x-treegrid-hd-hidden");)r=r.previousSibling;r&&(this.activeHd=Ext.get(r),u.cursor=Ext.isWebKit?"w-resize":"col-resize")}else delete this.activeHd,u.cursor=""}},onBeforeStart:function(){return this.dragHd=this.activeHd,!!this.dragHd},onStart:function(){this.dragHeadersDisabled=this.tree.headersDisabled,this.tree.headersDisabled=!0,this.proxy=this.tree.body.createChild({cls:"x-treegrid-resizer"}),this.proxy.setHeight(this.tree.body.getHeight());var n=this.tracker.getXY()[0];this.hdX=this.dragHd.getX(),this.hdIndex=this.tree.findHeaderIndex(this.dragHd),this.proxy.setX(this.hdX),this.proxy.setWidth(n-this.hdX),this.maxWidth=this.tree.outerCt.getWidth()-this.tree.innerBody.translatePoints(this.hdX).left},onDrag:function(){var n=this.tracker.getXY()[0];this.proxy.setWidth((n-this.hdX).constrain(this.minWidth,this.maxWidth))},onEnd:function(){var t=this.proxy.getWidth(),n=this.tree,i=this.dragHeadersDisabled;this.proxy.remove(),delete this.dragHd,n.columns[this.hdIndex].width=t,n.updateColumnWidths(),setTimeout(function(){n.headersDisabled=i},100)}});
/*!
 * Ext JS Library 3.4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.ux.tree.TreeGridNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{isTreeGridNodeUI:!0,renderElements:function(n,t,i,r){var l=n.getOwnerTree(),o=l.columns,u=o[0],f,s,h,c,e;for(this.indentMarkup=n.parentNode?n.parentNode.ui.getChildIndent():"",c=Ext.isBoolean(t.checked),s=['<tbody class="x-tree-node">','<tr ext:tree-node-id="',n.id,'" class="x-tree-node-el x-tree-node-leaf ',t.cls,'">','<td class="x-treegrid-col">','<span class="x-tree-node-indent">',this.indentMarkup,"<\/span>",'<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />','<img src="',t.icon||this.emptyIcon,'" class="x-tree-node-icon',t.icon?" x-tree-node-inline-icon":"",t.iconCls?" "+t.iconCls:"",'" unselectable="on" />',c?'<input class="x-tree-node-cb" type="checkbox" '+(t.checked?'checked="checked" />':"/>"):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',t.href?t.href:"#",'" tabIndex="1" ',t.hrefTarget?' target="'+t.hrefTarget+'"':"",">",'<span unselectable="on">',u.tpl?u.tpl.apply(t):t[u.dataIndex]||u.text,"<\/span><\/a>","<\/td>"],f=1,h=o.length;f<h;f++)u=o[f],s.push('<td class="x-treegrid-col ',u.cls?u.cls:"",'">','<div unselectable="on" class="x-treegrid-text"',u.align?' style="text-align: '+u.align+';"':"",">",u.tpl?u.tpl.apply(t):t[u.dataIndex],"<\/div>","<\/td>");for(s.push('<\/tr><tr class="x-tree-node-ct"><td colspan="',o.length,'">','<table class="x-treegrid-node-ct-table" cellpadding="0" cellspacing="0" style="table-layout: fixed; display: none; width: ',l.innerCt.getWidth(),'px;"><colgroup>'),f=0,h=o.length;f<h;f++)s.push('<col style="width: ',o[f].hidden?0:o[f].width,'px;" />');s.push("<\/colgroup><\/table><\/td><\/tr><\/tbody>"),this.wrap=r!==!0&&n.nextSibling&&n.nextSibling.ui.getEl()?Ext.DomHelper.insertHtml("beforeBegin",n.nextSibling.ui.getEl(),s.join("")):Ext.DomHelper.insertHtml("beforeEnd",i,s.join("")),this.elNode=this.wrap.childNodes[0],this.ctNode=this.wrap.childNodes[1].firstChild.firstChild,e=this.elNode.firstChild.childNodes,this.indentNode=e[0],this.ecNode=e[1],this.iconNode=e[2],c?(this.checkbox=e[3],this.anchor=e[4],this.textNode=e[4].firstChild):(this.anchor=e[3],this.textNode=e[3].firstChild)},animExpand:function(n){this.ctNode.style.display="",Ext.ux.tree.TreeGridNodeUI.superclass.animExpand.call(this,n)}}),Ext.ux.tree.TreeGridRootNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{isTreeGridNodeUI:!0,render:function(){if(this.rendered||(this.wrap=this.ctNode=this.node.ownerTree.innerCt.dom,this.node.expanded=!0),Ext.isWebKit){var n=this.ctNode;n.style.tableLayout=null,function(){n.style.tableLayout="fixed"}.defer(1)}},destroy:function(){this.elNode&&Ext.dd.Registry.unregister(this.elNode.id),delete this.node},collapse:Ext.emptyFn,expand:Ext.emptyFn});
/*!
 * Ext JS Library 3.4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.ux.tree.TreeGridLoader=Ext.extend(Ext.tree.TreeLoader,{createNode:function(n){return n.uiProvider||(n.uiProvider=Ext.ux.tree.TreeGridNodeUI),Ext.tree.TreeLoader.prototype.createNode.call(this,n)}});
/*!
 * Ext JS Library 3.4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
(function(){Ext.override(Ext.list.Column,{init:function(){var t=Ext.data.Types,n=this.sortType;this.type?Ext.isString(this.type)&&(this.type=Ext.data.Types[this.type.toUpperCase()]||t.AUTO):this.type=t.AUTO,Ext.isString(n)?this.sortType=Ext.data.SortTypes[n]:Ext.isEmpty(n)&&(this.sortType=this.type.sortType)}}),Ext.tree.Column=Ext.extend(Ext.list.Column,{}),Ext.tree.NumberColumn=Ext.extend(Ext.list.NumberColumn,{}),Ext.tree.DateColumn=Ext.extend(Ext.list.DateColumn,{}),Ext.tree.BooleanColumn=Ext.extend(Ext.list.BooleanColumn,{}),Ext.reg("tgcolumn",Ext.tree.Column),Ext.reg("tgnumbercolumn",Ext.tree.NumberColumn),Ext.reg("tgdatecolumn",Ext.tree.DateColumn),Ext.reg("tgbooleancolumn",Ext.tree.BooleanColumn)})();
/*!
 * Ext JS Library 3.4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.ux.tree.TreeGrid=Ext.extend(Ext.tree.TreePanel,{rootVisible:!1,useArrows:!0,lines:!1,borderWidth:Ext.isBorderBox?0:2,cls:"x-treegrid",bodyStyle:"overflow-y:hidden",columnResize:!0,enableSort:!0,reserveScrollOffset:!0,enableHdMenu:!0,columnsText:"Columns",initComponent:function(){var n,t;this.root||(this.root=new Ext.tree.AsyncTreeNode({text:"Root"})),n=this.loader,n?Ext.isObject(n)&&!n.load&&(n=new Ext.ux.tree.TreeGridLoader(n)):n=new Ext.ux.tree.TreeGridLoader({dataUrl:this.dataUrl,requestMethod:this.requestMethod,store:this.store}),this.loader=n,Ext.ux.tree.TreeGrid.superclass.initComponent.call(this),this.initColumns(),this.enableSort&&(this.treeGridSorter=new Ext.ux.tree.TreeGridSorter(this,this.enableSort)),this.columnResize&&(this.colResizer=new Ext.tree.ColumnResizer(this.columnResize),this.colResizer.init(this)),t=this.columns,this.internalTpl||(this.internalTpl=new Ext.XTemplate('<div class="x-grid3-header">','<div class="x-treegrid-header-inner">','<div class="x-grid3-header-offset">','<table style="table-layout: fixed;" cellspacing="0" cellpadding="0" border="0"><colgroup><tpl for="columns"><col /><\/tpl><\/colgroup>','<thead><tr class="x-grid3-hd-row">','<tpl for="columns">','<td class="x-grid3-hd x-grid3-cell x-treegrid-hd" style="text-align: {align};" id="',this.id,'-xlhd-{#}">','<div class="x-grid3-hd-inner x-treegrid-hd-inner" unselectable="on">',this.enableHdMenu?'<a class="x-grid3-hd-btn" href="#"><\/a>':"",'{header}<img class="x-grid3-sort-icon" src="',Ext.BLANK_IMAGE_URL,'" />',"<\/div>","<\/td><\/tpl>","<\/tr><\/thead>","<\/table>","<\/div><\/div>","<\/div>",'<div class="x-treegrid-root-node">','<table class="x-treegrid-root-table" cellpadding="0" cellspacing="0" style="table-layout: fixed;"><\/table>','<table style="height:25px;"><tr><td><\/td><\/tr><\/table>',"<\/div>")),this.colgroupTpl||(this.colgroupTpl=new Ext.XTemplate('<colgroup><tpl for="columns"><col style="width: {width}px"/><\/tpl><\/colgroup>'))},initColumns:function(){for(var i=this.columns,u=i.length,r=[],n,t=0;t<u;t++)n=i[t],n.isColumn||(n.xtype=n.xtype?/^tg/.test(n.xtype)?n.xtype:"tg"+n.xtype:"tgcolumn",n=Ext.create(n)),n.init(this),r.push(n),this.enableSort!==!1&&n.sortable!==!1&&(n.sortable=!0,this.enableSort=!0);this.columns=r},onRender:function(){if(Ext.tree.TreePanel.superclass.onRender.apply(this,arguments),this.el.addClass("x-treegrid"),this.outerCt=this.body.createChild({cls:"x-tree-root-ct x-treegrid-ct "+(this.useArrows?"x-tree-arrows":this.lines?"x-tree-lines":"x-tree-no-lines")}),this.internalTpl.overwrite(this.outerCt,{columns:this.columns}),this.mainHd=Ext.get(this.outerCt.dom.firstChild),this.innerHd=Ext.get(this.mainHd.dom.firstChild),this.innerBody=Ext.get(this.outerCt.dom.lastChild),this.innerCt=Ext.get(this.innerBody.dom.firstChild),this.colgroupTpl.insertFirst(this.innerCt,{columns:this.columns}),this.hideHeaders)this.el.child(".x-grid3-header").setDisplayed("none");else if(this.enableHdMenu!==!1){if(this.hmenu=new Ext.menu.Menu({id:this.id+"-hctx"}),this.enableColumnHide!==!1){this.colMenu=new Ext.menu.Menu({id:this.id+"-hcols-menu"});this.colMenu.on({scope:this,beforeshow:this.beforeColMenuShow,itemclick:this.handleHdMenuClick});this.hmenu.add({itemId:"columns",hideOnClick:!1,text:this.columnsText,menu:this.colMenu,iconCls:"x-cols-icon"})}this.hmenu.on("itemclick",this.handleHdMenuClick,this)}},setRootNode:function(n){return n.attributes.uiProvider=Ext.ux.tree.TreeGridRootNodeUI,n=Ext.ux.tree.TreeGrid.superclass.setRootNode.call(this,n),this.innerCt&&this.colgroupTpl.insertFirst(this.innerCt,{columns:this.columns}),n},clearInnerCt:function(){if(Ext.isIE)for(var n=this.innerCt.dom;n.firstChild;)n.removeChild(n.firstChild);else Ext.ux.tree.TreeGrid.superclass.clearInnerCt.call(this)},initEvents:function(){Ext.ux.tree.TreeGrid.superclass.initEvents.apply(this,arguments),this.mon(this.innerBody,"scroll",this.syncScroll,this),this.mon(this.innerHd,"click",this.handleHdDown,this),this.mon(this.mainHd,{scope:this,mouseover:this.handleHdOver,mouseout:this.handleHdOut})},onResize:function(n,t){var i,u,r,f;(Ext.ux.tree.TreeGrid.superclass.onResize.apply(this,arguments),i=this.innerBody.dom,u=this.innerHd.dom,i)&&(Ext.isNumber(t)&&(i.style.height=this.body.getHeight(!0)-u.offsetHeight+"px"),Ext.isNumber(n)&&(r=Ext.num(this.scrollOffset,Ext.getScrollBarWidth()),this.reserveScrollOffset||i.offsetWidth-i.clientWidth>10?this.setScrollOffset(r):(f=this,setTimeout(function(){f.setScrollOffset(i.offsetWidth-i.clientWidth>10?r:0)},10))))},updateColumnWidths:function(){for(var r=this.columns,o=r.length,i=this.outerCt.query("colgroup"),s=i.length,t,e,u,f,n=0;n<o;n++)for(t=r[n],u=0;u<s;u++)e=i[u],e.childNodes[n].style.width=(t.hidden?0:t.width)+"px";for(n=0,i=this.innerHd.query("td"),len=i.length;n<len;n++)t=Ext.fly(i[n]),r[n]&&r[n].hidden?t.addClass("x-treegrid-hd-hidden"):t.removeClass("x-treegrid-hd-hidden");f=this.getTotalColumnWidth(),Ext.fly(this.innerHd.dom.firstChild).setWidth(f+(this.scrollOffset||0)),this.outerCt.select("table").setWidth(f),this.syncHeaderScroll()},getVisibleColumns:function(){for(var i=[],t=this.columns,r=t.length,n=0;n<r;n++)t[n].hidden||i.push(t[n]);return i},getTotalColumnWidth:function(){for(var t=0,n=0,i=this.getVisibleColumns(),r=i.length;n<r;n++)t+=i[n].width;return t},setScrollOffset:function(n){this.scrollOffset=n,this.updateColumnWidths()},handleHdDown:function(n,t){var i=n.getTarget(".x-treegrid-hd"),r;if(i&&Ext.fly(t).hasClass("x-grid3-hd-btn")){var f=this.hmenu.items,e=this.columns,r=this.findHeaderIndex(i),u=e[r],o=u.sortable;n.stopEvent(),Ext.fly(i).addClass("x-grid3-hd-menu-open"),this.hdCtxIndex=r,this.fireEvent("headerbuttonclick",f,u,i,r);this.hmenu.on("hide",function(){Ext.fly(i).removeClass("x-grid3-hd-menu-open")},this,{single:!0});this.hmenu.show(t,"tl-bl?")}else i&&(r=this.findHeaderIndex(i),this.fireEvent("headerclick",this.columns[r],i,r))},handleHdOver:function(n,t){var i=n.getTarget(".x-treegrid-hd"),r;i&&!this.headersDisabled&&(index=this.findHeaderIndex(i),this.activeHdRef=t,this.activeHdIndex=index,r=Ext.get(i),this.activeHdRegion=r.getRegion(),r.addClass("x-grid3-hd-over"),this.activeHdBtn=r.child(".x-grid3-hd-btn"),this.activeHdBtn&&(this.activeHdBtn.dom.style.height=i.firstChild.offsetHeight-1+"px"))},handleHdOut:function(n){var t=n.getTarget(".x-treegrid-hd");!t||Ext.isIE&&n.within(t,!0)||(this.activeHdRef=null,Ext.fly(t).removeClass("x-grid3-hd-over"),t.style.cursor="")},findHeaderIndex:function(n){var i,t,r;for(n=n.dom||n,i=n.parentNode.childNodes,t=0;r=i[t];t++)if(r==n)return t;return-1},beforeColMenuShow:function(){var i=this.columns,r=i.length,n,t;for(this.colMenu.removeAll(),n=1;n<r;n++)t=i[n],t.hideable!==!1&&this.colMenu.add(new Ext.menu.CheckItem({itemId:"col-"+n,text:t.header,checked:!t.hidden,hideOnClick:!1,disabled:t.hideable===!1}))},handleHdMenuClick:function(n){var t=this.hdCtxIndex,i=n.getItemId();return this.fireEvent("headermenuclick",this.columns[t],i,t)!==!1&&(t=i.substr(4),t>0&&this.columns[t]&&this.setColumnVisible(t,!n.checked)),!0},setColumnVisible:function(n,t){this.columns[n].hidden=!t,this.updateColumnWidths()},scrollToTop:function(){this.innerBody.dom.scrollTop=0,this.innerBody.dom.scrollLeft=0},syncScroll:function(){this.syncHeaderScroll();var n=this.innerBody.dom;this.fireEvent("bodyscroll",n.scrollLeft,n.scrollTop)},syncHeaderScroll:function(){var n=this.innerBody.dom;this.innerHd.dom.scrollLeft=n.scrollLeft,this.innerHd.dom.scrollLeft=n.scrollLeft},registerNode:function(n){Ext.ux.tree.TreeGrid.superclass.registerNode.call(this,n),n.uiProvider||n.isRoot||n.ui.isTreeGridNodeUI||(n.ui=new Ext.ux.tree.TreeGridNodeUI(n))}}),Ext.reg("treegrid",Ext.ux.tree.TreeGrid)